Parameters:
    KnowledgeBaseRole:
        Type: String
    AgentRoleArn:
        Type: String
    KnowledgeBaseId:
        Type: String
Resources:
    MahitotsuYaAgent:
        Type: AWS::Bedrock::Agent
        Properties:
            AgentName: MahitotsuYaAgent
            AgentResourceRoleArn: !Ref AgentRoleArn
            FoundationModel: anthropic.claude-3-haiku-20240307-v1:0
            Instruction: |
                あなたは老舗和菓子店の販売員です。来店客からの質問と要望に対応します。
                質問には丁寧に回答してください。
                要望はツールを用いて実現してください。ツールの実行結果は来店客に報告してください。不明な点は来店客に質問して確認してください。
            AutoPrepare: true
            SkipResourceInUseCheckOnDelete: true
            KnowledgeBases:
                - KnowledgeBaseId: !Ref KnowledgeBaseId
                  KnowledgeBaseState: ENABLED
                  Description: 店舗に固有の情報が蓄積された知識ベースです。``
            ActionGroups:
                - ActionGroupName: UserInputAction
                  ActionGroupState: ENABLED
                  ParentActionGroupSignature: AMAZON.UserInput
                  SkipResourceInUseCheckOnDelete: true
    MahitotsuYaAgentAlias:
        Type: AWS::Bedrock::AgentAlias
        Properties:
            AgentId: !Ref MahitotsuYaAgent
            AgentAliasName: CurrentVersion
            Description: !GetAtt MahitotsuYaAgent.PreparedAt
